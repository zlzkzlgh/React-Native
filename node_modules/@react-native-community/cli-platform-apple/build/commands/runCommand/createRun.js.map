{"version":3,"names":["createRun","platformName","_","ctx","args","link","setPlatform","platformConfig","project","sdkNames","readableName","platformReadableName","getPlatformInfo","undefined","supportedPlatforms","CLIError","packager","port","installedPods","automaticPodsInstallation","forcePods","isAppRunningNewArchitecture","sourceDir","getArchitecture","resolvePods","root","dependencies","forceInstall","newArchEnabled","newPort","startPackager","findDevServerPort","startServerInNewWindow","reactNativePath","terminal","reactNativeVersion","setVersion","xcodeProject","getXcodeProjectAndDir","process","chdir","binaryPath","path","isAbsolute","join","fs","existsSync","mode","scheme","getConfiguration","buildOutput","buildProject","openApp","target","devices","listDevices","length","logger","error","packageJson","getPackageJson","preferredDevice","cacheManager","get","name","preferredDeviceIndex","findIndex","udid","device","splice","unshift","fallbackSimulator","getFallbackSimulator","interactive","warn","selectedDevice","promptForDeviceSelection","set","type","runOnSimulator","runOnDevice","simulator","bootedSimulators","filter","state","bootedDevices","booted","info","map","find","d","chalk","bold","printFoundDevices","matchingDevice","deviceByUdid"],"sources":["../../../src/commands/runCommand/createRun.ts"],"sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport path from 'path';\nimport fs from 'fs';\nimport chalk from 'chalk';\nimport {Config, IOSProjectConfig} from '@react-native-community/cli-types';\nimport {\n  logger,\n  CLIError,\n  link,\n  startServerInNewWindow,\n  findDevServerPort,\n  cacheManager,\n} from '@react-native-community/cli-tools';\nimport getArchitecture from '../../tools/getArchitecture';\nimport listDevices from '../../tools/listDevices';\nimport resolvePods, {getPackageJson} from '../../tools/pods';\nimport {promptForDeviceSelection} from '../../tools/prompts';\nimport {BuildFlags} from '../buildCommand/buildOptions';\nimport {buildProject} from '../buildCommand/buildProject';\nimport {getConfiguration} from '../buildCommand/getConfiguration';\nimport {getXcodeProjectAndDir} from '../buildCommand/getXcodeProjectAndDir';\nimport {getFallbackSimulator} from './getFallbackSimulator';\nimport {getPlatformInfo} from './getPlatformInfo';\nimport {printFoundDevices, matchingDevice} from './matchingDevice';\nimport {runOnDevice} from './runOnDevice';\nimport {runOnSimulator} from './runOnSimulator';\nimport {BuilderCommand} from '../../types';\nimport {supportedPlatforms} from '../../config/supportedPlatforms';\nimport openApp from './openApp';\n\nexport interface FlagsT extends BuildFlags {\n  simulator?: string;\n  device?: string | true;\n  udid?: string;\n  binaryPath?: string;\n  listDevices?: boolean;\n  packager?: boolean;\n  port: number;\n  terminal?: string;\n}\n\nconst createRun =\n  ({platformName}: BuilderCommand) =>\n  async (_: Array<string>, ctx: Config, args: FlagsT) => {\n    // React Native docs assume platform is always ios/android\n    link.setPlatform('ios');\n    const platformConfig = ctx.project[platformName] as IOSProjectConfig;\n    const {sdkNames, readableName: platformReadableName} =\n      getPlatformInfo(platformName);\n\n    if (\n      platformConfig === undefined ||\n      supportedPlatforms[platformName] === undefined\n    ) {\n      throw new CLIError(\n        `Unable to find ${platformReadableName} platform config`,\n      );\n    }\n\n    let {packager, port} = args;\n    let installedPods = false;\n    // check if pods need to be installed\n    if (platformConfig.automaticPodsInstallation || args.forcePods) {\n      const isAppRunningNewArchitecture = platformConfig.sourceDir\n        ? await getArchitecture(platformConfig.sourceDir)\n        : undefined;\n\n      await resolvePods(ctx.root, ctx.dependencies, platformName, {\n        forceInstall: args.forcePods,\n        newArchEnabled: isAppRunningNewArchitecture,\n      });\n\n      installedPods = true;\n    }\n\n    if (packager) {\n      const {port: newPort, startPackager} = await findDevServerPort(\n        port,\n        ctx.root,\n      );\n\n      if (startPackager) {\n        await startServerInNewWindow(\n          newPort,\n          ctx.root,\n          ctx.reactNativePath,\n          args.terminal,\n        );\n      }\n    }\n\n    if (ctx.reactNativeVersion !== 'unknown') {\n      link.setVersion(ctx.reactNativeVersion);\n    }\n\n    let {xcodeProject, sourceDir} = getXcodeProjectAndDir(\n      platformConfig,\n      platformName,\n      installedPods,\n    );\n\n    process.chdir(sourceDir);\n\n    if (args.binaryPath) {\n      args.binaryPath = path.isAbsolute(args.binaryPath)\n        ? args.binaryPath\n        : path.join(ctx.root, args.binaryPath);\n\n      if (!fs.existsSync(args.binaryPath)) {\n        throw new CLIError(\n          'binary-path was specified, but the file was not found.',\n        );\n      }\n    }\n\n    const {mode, scheme} = await getConfiguration(\n      xcodeProject,\n      sourceDir,\n      args,\n      platformName,\n    );\n\n    if (platformName === 'macos') {\n      const buildOutput = await buildProject(\n        xcodeProject,\n        platformName,\n        undefined,\n        mode,\n        scheme,\n        args,\n      );\n\n      openApp({\n        buildOutput,\n        xcodeProject,\n        mode,\n        scheme,\n        target: args.target,\n        binaryPath: args.binaryPath,\n      });\n\n      return;\n    }\n\n    let devices = await listDevices(sdkNames);\n\n    if (devices.length === 0) {\n      return logger.error(\n        `${platformReadableName} devices or simulators not detected. Install simulators via Xcode or connect a physical ${platformReadableName} device`,\n      );\n    }\n\n    const packageJson = getPackageJson(ctx.root);\n\n    const preferredDevice = cacheManager.get(\n      packageJson.name,\n      'lastUsedIOSDeviceId',\n    );\n\n    if (preferredDevice) {\n      const preferredDeviceIndex = devices.findIndex(\n        ({udid}) => udid === preferredDevice,\n      );\n\n      if (preferredDeviceIndex > -1) {\n        const [device] = devices.splice(preferredDeviceIndex, 1);\n        devices.unshift(device);\n      }\n    }\n\n    const fallbackSimulator =\n      platformName === 'ios' ? getFallbackSimulator(args) : devices[0];\n\n    if (args.listDevices || args.interactive) {\n      if (args.device || args.udid) {\n        logger.warn(\n          `Both ${\n            args.device ? 'device' : 'udid'\n          } and \"list-devices\" parameters were passed to \"run\" command. We will list available devices and let you choose from one.`,\n        );\n      }\n\n      const selectedDevice = await promptForDeviceSelection(devices);\n\n      if (!selectedDevice) {\n        throw new CLIError(\n          `Failed to select device, please try to run app without ${\n            args.listDevices ? 'list-devices' : 'interactive'\n          } command.`,\n        );\n      } else {\n        if (selectedDevice.udid !== preferredDevice) {\n          cacheManager.set(\n            packageJson.name,\n            'lastUsedIOSDeviceId',\n            selectedDevice.udid,\n          );\n        }\n      }\n\n      if (selectedDevice.type === 'simulator') {\n        return runOnSimulator(\n          xcodeProject,\n          platformName,\n          mode,\n          scheme,\n          args,\n          selectedDevice,\n        );\n      } else {\n        return runOnDevice(\n          selectedDevice,\n          platformName,\n          mode,\n          scheme,\n          xcodeProject,\n          args,\n        );\n      }\n    }\n\n    if (!args.device && !args.udid && !args.simulator) {\n      const bootedSimulators = devices.filter(\n        ({state, type}) => state === 'Booted' && type === 'simulator',\n      );\n      const bootedDevices = devices.filter(({type}) => type === 'device'); // Physical devices here are always booted\n      const booted = [...bootedSimulators, ...bootedDevices];\n\n      if (booted.length === 0) {\n        logger.info(\n          'No booted devices or simulators found. Launching first available simulator...',\n        );\n        return runOnSimulator(\n          xcodeProject,\n          platformName,\n          mode,\n          scheme,\n          args,\n          fallbackSimulator,\n        );\n      }\n\n      logger.info(`Found booted ${booted.map(({name}) => name).join(', ')}`);\n\n      for (const simulator of bootedSimulators) {\n        await runOnSimulator(\n          xcodeProject,\n          platformName,\n          mode,\n          scheme,\n          args,\n          simulator || fallbackSimulator,\n        );\n      }\n\n      for (const device of bootedDevices) {\n        await runOnDevice(\n          device,\n          platformName,\n          mode,\n          scheme,\n          xcodeProject,\n          args,\n        );\n      }\n\n      return;\n    }\n\n    if (args.device && args.udid) {\n      return logger.error(\n        'The `device` and `udid` options are mutually exclusive.',\n      );\n    }\n\n    if (args.udid) {\n      const device = devices.find((d) => d.udid === args.udid);\n      if (!device) {\n        return logger.error(\n          `Could not find a device with udid: \"${chalk.bold(\n            args.udid,\n          )}\". ${printFoundDevices(devices)}`,\n        );\n      }\n      if (device.type === 'simulator') {\n        return runOnSimulator(\n          xcodeProject,\n          platformName,\n          mode,\n          scheme,\n          args,\n          fallbackSimulator,\n        );\n      } else {\n        return runOnDevice(\n          device,\n          platformName,\n          mode,\n          scheme,\n          xcodeProject,\n          args,\n        );\n      }\n    } else if (args.device) {\n      let device = matchingDevice(devices, args.device);\n\n      if (!device) {\n        const deviceByUdid = devices.find((d) => d.udid === args.device);\n        if (!deviceByUdid) {\n          return logger.error(\n            `Could not find a physical device with name or unique device identifier: \"${chalk.bold(\n              args.device,\n            )}\". ${printFoundDevices(devices, 'device')}`,\n          );\n        }\n\n        device = deviceByUdid;\n\n        if (deviceByUdid.type === 'simulator') {\n          return logger.error(\n            `The device with udid: \"${chalk.bold(\n              args.device,\n            )}\" is a simulator. If you want to run on a simulator, use the \"--simulator\" flag instead.`,\n          );\n        }\n      }\n\n      if (device && device.type === 'simulator') {\n        return logger.error(\n          \"`--device` flag is intended for physical devices. If you're trying to run on a simulator, use `--simulator` instead.\",\n        );\n      }\n\n      if (device && device.type === 'device') {\n        return runOnDevice(\n          device,\n          platformName,\n          mode,\n          scheme,\n          xcodeProject,\n          args,\n        );\n      }\n    } else {\n      runOnSimulator(\n        xcodeProject,\n        platformName,\n        mode,\n        scheme,\n        args,\n        fallbackSimulator,\n      );\n    }\n  };\n\nexport default createRun;\n"],"mappings":"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"}